role:
  created_date: "20250814"
  name: build-odh-operator
  description: |
    This role provides easily build of the opendatahub-operator image from the incubating branch, simplifying the process and improving development efficiency.

    pre-requirements:
      - podman on local
      - You have to login to registry quay.io before running this role.

    Input Environment:
      The parameters include:
      - QUAY_NAME: Set your quay user name to push image to quay.io
      - ODH_OPERATOR_BRANCH: Set the branch name of the opendatahub-operator repository to build(default-incubating)
      - KSERVE_MANIFESTS_BRANCH_URL: Repository url of the kserve-controller manifests branch (e.g. "https://github.com/jooho/kserve/tree/loopy-test-devflag")
      - ODH_MODEL_CONTROLLER_MANIFESTS_BRANCH_URL: Repository url of the odh-model-controller manifests branch (e.g. "https://github.com/jooho/odh-model-controller/tree/loopy-test-devflag")
      - VERSION: Set version for opendatahub-operator package. By default, it will use the version from makefile)

    To run it:
    
    loopy roles run build-odh-operator \
      -p QUAY_NAME=jooholee \
      -p KSERVE_MANIFESTS_BRANCH_URL=https://github.com/jooho/kserve/tree/loopy-test-devflag \
      -p VERSION=2.34.9

  input_env:
  - name: QUAY_NAME
    description: Set your quay user name to push image to quay.io
    required: true

  - name: OPENDATAHUB_TYPE
    description: Set the type of the opendatahub (default:odh, you can set to rhoai)
    default: "odh"

  - name: ODH_OPERATOR_BRANCH
    description: Set the branch name of the opendatahub-operator repository to build(default-incubating)
    default: "incubation"

  - name: KSERVE_MANIFESTS_BRANCH_URL
    description: Repository url of the kserve-controller manifests branch (e.g. "https://github.com/jooho/kserve/tree/loopy-test-devflag")

  - name: ODH_MODEL_CONTROLLER_MANIFESTS_BRANCH_URL
    description: Repository url of the odh-model-controller manifests branch (e.g. "https://github.com/jooho/odh-model-controller/tree/loopy-test-devflag")

  - name: VERSION
    description: Set version for opendatahub-operator package. By default, it will use the version from makefile)

  output_env:
  - name: ODH_OPERATOR_CATALOG_IMG
    description: catalog image url (e.g. "quay.io/jooholee/odh-operator-index:loopy")
